## 进程与线程

计算机的核心是CPU，它承担了所有的计算任务。它就像一座工厂，时刻在运行。

进程就好比工厂的车间，它代表CPU所能处理的单个任务。任一时刻，CPU总是运行一个进程，其他进程处于非运行状态。

一个车间里，可以有很多工人。他们协同完成一个任务。线程就好比车间里的工人。**一个进程可以包括多个线程**。

操作系统的设计，因此可以归结为三点：

- 以多进程形式，允许多个任务同时运行；
- 以多线程形式，允许单个任务分成不同的部分运行；
- 提供协调机制，一方面防止进程之间和线程之间产生冲突，另一方面允许进程之间和线程之间共享资源。

## 理解异步

**同步**：主线程上排队执行的任务，只有前面的任务执行完，才能执行后面的任务。
**异步**：是指不进入主线程，而是进入任务队列的任务,只有任务队列通知主线程，某个任务可以执行了，该任务才会进入主线程执行。

### 单线程的 js 如何实现异步？

通过浏览器的内核多线程实现异步。

![](../../images/js/singlethread.png)

- **GUI 线程**：负责渲染页面，解析 html、css；构建 DOM 树和渲染树;
- **js 引擎线程**： 负责解析和执行 js 程序，我们经常听到的 chrome 的 v8 引擎就是跑在 js 引擎线程上的，js 引擎线程只有一个，所有说 js 的单线程语言的原因，那其实语言没有单线程多线程之说，因为解释这个语言的是 的线程是单线程；js 引擎线程与 gui 线程互斥，当浏览器执行 javaScript 程序的时候，GUI 渲染线层会保存在一个队列当中；直到 js 程序执行完成，才会接着执行；如果 js 的执行时间过长，会影响页面的渲染不连贯，所有我们要尽量控制 js 的大小;
- **定时触发线程**：为什么 setTimeout 不阻塞后面程序的运行，那其实 setTimeout 不是由 js 引擎线程完成的，是由定时器触发线程完成的，所以它们可以是同时进行的，那么定时器触发线程在这定时任务完成之后会通知事件触发线程往任务队列里添加事件;
- **事件触发线程**：将满足触发条件的事件放入任务队列，一些异步的事件会放到异步队列中;
- **异步 HTTP 请求线程**：用与处理 ajax 请求的，当请求完成时如果有回调函数就通知事件触发线程往任务队列中添加任务;

## 事件循环（Event Loop）

![](../../images/js/event-loop.gif)

## 异步编程方法

### 发布订阅模式

### Promise

### async/await


## 参考

- [进程与线程 - 阮一峰](https://www.ruanyifeng.com/blog/2013/04/processes_and_threads.html)
- [Web 全栈体系](https://hejialianghe.gitee.io/jsadvanced/asyncpro.html)